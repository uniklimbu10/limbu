<!doctype html>
<html>
<head>
    <style>
        .bar {
            fill: steelblue;
        }
    </style>
    <script src="https://d3js.org/d3.v4.min.js"></script>
</head>
<body>
<!-- size of the svg -->    
<svg width="1350" height="500"></svg> 
<script>

//svg variable for the margin of the bar chart
var svg = d3.select("svg"), 
            margin = 200,
            width = svg.attr("width") - margin,
            height = svg.attr("height") - margin

//creates the title on the svg            
    svg.append("text") 
       .attr("transform", "translate(100,0)") //translates the text
       .attr("x", 200) 
       .attr("y", 50)
       .attr("stroke", "black")
       .attr("font-size", "32px")
       .text("Quality Assurance Range Calorimeter (QuARC) GUI")

//variables that are used for scaling the x and y data values into visual valyes such as positions on the graph
var xScale = d3.scaleBand().range([0, width]).padding(0.4), //scaleBand() are useful for charts with a categorial dimension
    yScale = d3.scaleLinear().range([height, 0]); //scaleLinear() constructs a scale with linear realtionship between input and output

var minY = 0;
let maxY = 600; //default - typical max charge

//variable g is where the bars and the axis would be placed
var g = svg.append("g")
            .attr("transform", "translate(" + 100 + "," + 100 + ")"); 
            
    d3.csv("pdVal.csv", function(error, data) { //parses the data and returns it as an object
        if (error) {
            throw error;
        }

        xScale.domain(data.map(function(d) { return d.pdNum; }));
        yScale.domain([minY, maxY]); 
        
        //checking the data 
        console.log(data.map(function(d) { return d.pdNum; }));

        //creates x axis on g
        g.append("g")
         .attr("transform", "translate(0," + height + ")")
         .call(d3.axisBottom(xScale))
         .append("text")
         .attr("y", height - 250)
         .attr("x", width - 100)
         .attr("text-anchor", "end")
         .attr("stroke", "black")
         .text("Photodiode Number")

        //creates y axis on g
        g.append("g")
         .call(d3.axisLeft(yScale).tickFormat(function(d){
             return d;
         }).ticks(10))
           .append("text")
           .attr("transform", "rotate(-90)")
           .attr("y", 6)
           .attr("dy", "-5.1em")
           .attr("text-anchor", "end")
           .attr("stroke", "black")
           .text("Charge / pC");

        //adds the bar on g
        g.selectAll(".bar")
         .data(data)
         .enter().append("rect")
         .attr("class", "bar")
         .attr("x", function(d) { return xScale(d.pdNum); })
         .attr("y", function(d) { return yScale(d.pdVal); })
         .attr("width", xScale.bandwidth())
         .attr("height", function(d) { return height - yScale(d.pdVal); });
    });
</script>
</body>
</html>